<!doctype html>
<html lang="th">
<head>
<meta charset="UTF-8">
<base target="_top">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Wisdom TA</title>

<link rel="manifest" href="manifest.json">

<link rel="icon" type="image/png" href="https://thamanoonni.github.io/ta/icon-wda.png">
<link rel="apple-touch-icon" href="https://thamanoonni.github.io/ta/icon-wda.png">

<meta name="theme-color" content="#0d6efd">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
    /* ปรับแต่งให้เต็มจอจริงๆ ไม่มีขอบ */
    body, html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
    }
    iframe {
        border: none;
        width: 100%;
        height: 100%;
        display: block; /* แก้ปัญหาขอบขาวด้านล่าง */
    }
</style>
</head>
<body>
    <iframe src="https://script.google.com/macros/s/AKfycbz_oc01CH9M06vnw39jCjvy2VIYi54kiE29E0xeyAqqyYrTFkcb9rF-aQelzTTp9Ngt/exec" allow="geolocation; camera; microphone"></iframe>
<script>
  // 1. ลงทะเบียน Service Worker (จำเป็นสำหรับ PWA)
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js')
      .then(() => console.log('Service Worker Registered'));
  }
    
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js').then(() => console.log('Service Worker Registered'));
  }
  // 2. Logic สำหรับปุ่ม "ติดตั้งลงเครื่อง"
  let deferredPrompt;
  
  window.addEventListener('beforeinstallprompt', (e) => {
    // ป้องกันไม่ให้ Chrome โชว์แถบอัตโนมัติ (เราจะโชว์เอง)
    e.preventDefault();
    deferredPrompt = e;
    
    // เรียกฟังก์ชันแสดงปุ่มติดตั้ง (ท่านต้องสร้างปุ่มนี้ใน HTML)
    showInstallPromotion(); 
  });

  function showInstallPromotion() {
      // สร้างปุ่มติดตั้งลอยขึ้นมา หรือ แทรกในหน้า Login
      // ตัวอย่าง: ใช้ SweetAlert ที่ท่านมีอยู่แล้ว
      Swal.fire({
          title: 'ติดตั้งแอป (Office)',
          text: 'เพื่อความสะดวกในการใช้งานครั้งต่อไป',
          icon: 'info',
          showCancelButton: true,
          confirmButtonText: 'ติดตั้งเลย',
          cancelButtonText: 'ไว้ทีหลัง',
          confirmButtonColor: '#0d6efd'
      }).then((result) => {
          if (result.isConfirmed) {
              // สั่งให้ติดตั้ง
              deferredPrompt.prompt();
              deferredPrompt.userChoice.then((choiceResult) => {
                  if (choiceResult.outcome === 'accepted') {
                      console.log('User accepted the A2HS prompt');
                  }
                  deferredPrompt = null;
              });
          }
      });
  }
</script>    
</body>
</html>
















